

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Best Practices &mdash; Quantified Uncertainty with Optimization for the FEM  documentation</title>
  

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js"></script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
<script src="https://cdn.jsdelivr.net/npm/vega@5.12.1"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4.13.1"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6.8.0"></script>
<style media="screen">.vega-actions a {margin-right: 5px;}</style>
<link href="../../../../../_static/css/bootstrap.css" rel="stylesheet">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F2F2F2" >
          
<a href="https://simcenter.designsafe-ci.org/" style="margin-bottom: 0px;">
  <img src="../../../../../_static/img/SimCenter-Only.png" class="logo" alt="Org-Logo" />
</a>
<hr style="margin: 0px;">

  <a href="../../../../../index.html">



  
  <img src="../../../../../_static/quoFEM-Logo.png" class="logo" alt="Logo"/>

</a>


  
  



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about/quoFEM/aboutQUOFEM.html">1. About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../front-matter/ack.html">2. Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../front-matter/license.html">3. Copyright and License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../front-matter/glossary.html">4. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../front-matter/abbreviations.html">5. Abbreviations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/desktop/installation.html">1. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">2. User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshooting/desktop/troubleshooting.html">3. Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/desktop/examples.html">4. Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reqments/reqQUOFEM.html">5. Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../bugs.html">6. Bugs &amp; Feature Requests</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../technical_manual/desktop/technical_manual.html">1. Technical Manual</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_manual/how_to_build/desktop/how_to_build.html">1. How to Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_manual/architecture/desktop/architecture.html">2. Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_manual/how_to_extend/desktop/how_to_extend.html">3. How to Extend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_manual/verification/desktop/verification.html">4. Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_manual/coding_style/desktop/coding_style.html">5. Coding Style</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Quantified Uncertainty with Optimization for the FEM</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Best Practices</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../../_sources/common/user_manual/usage/desktop/hydro/bestpractices.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="best-practices">
<span id="lbl-bestpractices"></span><h1>Best Practices<a class="headerlink" href="#best-practices" title="Permalink to this headline">¶</a></h1>
<div class="section" id="errors-and-uncertainties">
<h2>Errors and uncertainties<a class="headerlink" href="#errors-and-uncertainties" title="Permalink to this headline">¶</a></h2>
<p>There are several sources of errors that are often observed in CFD simulations. These include:</p>
<ol class="arabic simple">
<li><p>The model is described by the Navier-Stokes equations. The exact N-S equations are solved when Direct Numerical Simulations (DNS) are employed. However, when the RANS approach is involved, as in HydroUQ, this involves approximations that could lead to errors and uncertainties. Thus, selecting the correct parameters is paramount.</p></li>
<li><p>If the solution shows divergence, check the boundary conditions, grid, discretization, and convergence errors. Check whether the flow is steady or unsteady and the timestep used in this regard.</p></li>
</ol>
</div>
<div class="section" id="froude-number">
<h2>Froude number<a class="headerlink" href="#froude-number" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>One of the essential non-dimensional numbers that describe different flow regimes for open channel flow. It is a dimensionless quantity that is a ratio of the inertial and gravitational forces as <span class="math notranslate nohighlight">\(Fr = \frac{V}{\sqrt{gD}}\)</span>. Here <code class="docutils literal notranslate"><span class="pre">V</span></code> is the water velocity, <code class="docutils literal notranslate"><span class="pre">D</span></code> is the hydraulic depth across the cross-sectional area of the flow, and <code class="docutils literal notranslate"><span class="pre">g</span></code> is the gravity.</p></li>
<li><p>It is important to calculate if the flow is sub-critical (Fr &lt; 1) or critical (Fr = 1) or supercritical (Fr &gt; 1). Critical flows are often unstable and set up standing waves between sub and supercritical flows.</p></li>
<li><p>It is necessary to consider both the Froude number and Reynolds number to determine separation effects like breaking waves.</p></li>
</ol>
</div>
<div class="section" id="spatial-discretization">
<h2>Spatial discretization<a class="headerlink" href="#spatial-discretization" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Mesh checking is always essential. quoFEM app performs a mesh check, and the log is available for review after the simulation is complete. It is much recommended to review this.</p></li>
<li><p>Mesh convergence study is critical to ensuring good and reliable results using CFD simulations. Thus, it is strongly recommended to estimate the error by refining the mesh, if possible.</p></li>
<li><p>Using a fine grid throughout may reduce the convergence rate. Instead, use grid adaptation or refine the mesh in areas of a large gradient to reduce computational cost. Use grid refinement where local details are required.</p></li>
<li><p>quoFEM app has a basic mesher available that generates hex grids. For complex geometries, it is recommended to create hybrid grids using external meshing tools. Such grids can generally use prism layer grids in the boundary layer, tetrahedral cells in the core flow region, and hex grids.</p></li>
<li><p>It is recommended that the aspect ratio be below 5 but can be up to 10 inside the boundary layer. Ensure that the change in grid size is gradual, and the maximum variation in grid spacing should be less than 20%.</p></li>
</ol>
<p># Avoid highly skewed cells so that the angles between gridlines are orthogonal or near orthogonal. Angles with less than 40-degrees or greater than 140-degrees may lead to numerical instabilities or unsatisfactory results.</p>
</div>
<div class="section" id="temporal-discretization">
<h2>Temporal discretization<a class="headerlink" href="#temporal-discretization" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>It is suggested to take a small timestep to start with so that it can be automatically increased to check the influence of timesteps on the results.</p></li>
<li><p>The timestep size should be decided based on the <a class="reference external" href="https://en.wikipedia.org/wiki/Courant%E2%80%93Friedrichs%E2%80%93Lewy_condition">Courant-Friedrichs-Lewy (CFL) condition</a> . Yet, it should also be small enough to capture any transient phenomena of interest.</p></li>
<li><p>Using the log files, ensure that the simulation has converged at each time step. For temporal accuracy, it is recommended to use a second-order accurate discretization scheme like <a class="reference external" href="https://en.wikipedia.org/wiki/Crank%E2%80%93Nicolson_method">Crank-Nicolson</a>.</p></li>
</ol>
</div>
<div class="section" id="boundary-conditions">
<h2>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">EVT</span></code> requires one to provide six boundary conditions for the six standard patches <code class="docutils literal notranslate"><span class="pre">Entry</span></code>, <code class="docutils literal notranslate"><span class="pre">Exit</span></code>, <code class="docutils literal notranslate"><span class="pre">Right</span></code>, <code class="docutils literal notranslate"><span class="pre">Left</span></code>, <code class="docutils literal notranslate"><span class="pre">Bottom</span></code> and <code class="docutils literal notranslate"><span class="pre">Top</span></code>.</p></li>
<li><p>If no boundary condition is specified for a particular patch, it is assumed to be <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">empty</span></code> by default. Presently, quoFEM app only allows specification of the velocity and pressure boundary conditions. If you would like to specify other parameters, please write to us at <a class="reference internal" href="../../../bugs.html#lblbugs"><span class="std std-ref">Bugs &amp; Feature Requests</span></a>.</p></li>
<li><p>The inlet boundary condition should be used for patches where it has a weak influence on the downstream flow. Perform a sensitivity analysis on the inlet flow direction, magnitude, and profile. The exact inlet turbulence conditions are usually unknown. Thus, 1% turbulent intensity can be assumed for external flows.</p></li>
<li><p>The outlet boundary condition should be specified on the patch, which has a weak influence on the upstream flow. It is suggested to set the convective derivative normal to the outlet boundary face to be zero. However, for flow with strong pressure gradients, special non-reflecting boundary conditions would be required.</p></li>
<li><p>Ensure that the wall boundary conditions are specified for the solid walls.</p></li>
</ol>
</div>
<div class="section" id="sw-cfd-domain-sizes">
<h2>SW-CFD domain sizes<a class="headerlink" href="#sw-cfd-domain-sizes" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Note that each degree of latitude is approximately 69 miles (111 km apart). At the Equator, the distance is 68.703 miles (110.567 km); at Tropic of Cancer and Capricorn, it is 68.94 miles (110.948 km), and at the poles, it is 69.94 miles (111.699 km).</p></li>
<li><p>60 minutes = 1 degree</p></li>
<li><p>For a 1-minute grid used in the SW-solver, this is approximately a 2 x 2 km grid (in terms of distances). This could still be a considerably large domain for the CFD simulation, depending on the topography and bathymetry.</p></li>
<li><p>If the simulation type is SW-CFD coupling, then there can be wave reflections. Such wave reflections can lead to unphysical fluid accumulation at the boundary.</p></li>
</ol>
</div>
<div class="section" id="turbulence-modeling">
<h2>Turbulence modeling<a class="headerlink" href="#turbulence-modeling" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Compute the Reynolds number to determine if the flow is turbulent. Do not use turbulent models for laminar flows.</p></li>
<li><p>Estimate the y+ and the thickness of the first cell layer. The ideal distance of the first node from the wall <span class="math notranslate nohighlight">\(\Delta y\)</span> can be estimated to be</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-common-user-manual-usage-desktop-hydro-bestpractices-0">
<span class="eqno">()<a class="headerlink" href="#equation-common-user-manual-usage-desktop-hydro-bestpractices-0" title="Permalink to this equation">¶</a></span>\[\Delta y = L \cdot y^{+} \cdot \sqrt{74} \cdot {Re}_{L}^{-13/14}\]</div>
</div></blockquote>
</li>
</ol>
<p>where <span class="math notranslate nohighlight">\(L\)</span> is the characteristic length scale, <span class="math notranslate nohighlight">\(y^{+}\)</span> is the desired values, <span class="math notranslate nohighlight">\({Re}_{L}\)</span> is the Reynolds number. The non-dimensionalized velocity (<span class="math notranslate nohighlight">\(u^{+}\)</span>) and distance from the wall (<span class="math notranslate nohighlight">\(y^{+}\)</span>), the velocity profile of the boundary layers, takes on the form, as shown below by the red line in  <code class="xref std std-numref docutils literal notranslate"><span class="pre">yplusform</span></code>.</p>
<blockquote>
<div><div class="align-center figure" id="id1">
<span id="yplusform"></span><a class="reference internal image-reference" href="../../../../../_images/yplus.png"><img alt="../../../../../_images/yplus.png" src="../../../../../_images/yplus.png" style="height: 400px;" /></a>
<p class="caption"><span class="caption-text">The variation of non-dimensional velocity and distance</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div></blockquote>
<ol class="arabic">
<li><p>Various online calculators can be used to calculate the value of <span class="math notranslate nohighlight">\(y^{+}\)</span>. Some examples of apps include: <a class="reference external" href="https://play.google.com/store/apps/details?id=com.pointwise.ypluscalculator">Google Play Store</a> or <a class="reference external" href="https://apps.apple.com/us/app/y-calculator/id650011524">Apple store</a> .</p></li>
<li><p>If the flow is believed to be viscous, then the viscous sub-layers need to be resolved as shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">Viscousyplus</span></code>. When meshed correctly, a value of <span class="math notranslate nohighlight">\(y^{+} \approx 1\)</span> is desired. Alternatively, a wall model can be used bu having the first element in the region <span class="math notranslate nohighlight">\(y^{+} &gt; 30\)</span>. It is a good practice to avoid a <span class="math notranslate nohighlight">\(y^{+}\)</span> value between these values.</p>
<blockquote>
<div><div class="align-center figure" id="id2">
<span id="viscousyplus"></span><a class="reference internal image-reference" href="../../../../../_images/Viscousyplus.png"><img alt="../../../../../_images/Viscousyplus.png" src="../../../../../_images/Viscousyplus.png" style="height: 300px;" /></a>
<p class="caption"><span class="caption-text">Resolution of the viscous sub-layer</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div></blockquote>
</li>
<li><p>High Reynolds number flows (like aircraft, ships, etc.) will experience boundary layers that extend to several thousand <span class="math notranslate nohighlight">\(y^{+}\)</span> units. However, for flows with low Reynolds numbers, the upper limit can be as little as 100 <span class="math notranslate nohighlight">\(y^{+}\)</span> units. Thus, it is necessary to ensure that the first node does not fall outside this range.</p></li>
<li><p>quoFEM app 2.0 supports <span class="math notranslate nohighlight">\(k-\epsilon\)</span> and <span class="math notranslate nohighlight">\(k-\omega\)</span> SST models. These are both good choices for general applications. The <span class="math notranslate nohighlight">\(k-\epsilon\)</span> model is very reliable and can often be used to get initial values for more sophisticated models.</p></li>
<li><p>The <span class="math notranslate nohighlight">\(k-\epsilon\)</span> model is inaccurate for flows with adverse pressure gradients. It does not allow integration of the conservation equations through the viscous sublayer where low Reynolds number corrections are recommended.</p></li>
<li><p>The <span class="math notranslate nohighlight">\(k-\omega\)</span> model is very sensitive to the freestream boundary conditions. However, it performs well for flows with variable pressure gradients.</p></li>
</ol>
</div>
<div class="section" id="user-errors">
<h2>User errors<a class="headerlink" href="#user-errors" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Check for details in the geometry. Do not over-simplify the geometry without an understanding of the given problem.</p></li>
<li><p>Inaccurate use of boundary conditions, poor-quality grids are commonly observed user errors.</p></li>
<li><p>Ensure that the timestep sizes provided are reasonable.</p></li>
</ol>
</div>
<div class="section" id="checking-results">
<h2>Checking results<a class="headerlink" href="#checking-results" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Check the overall mass balance.</p></li>
<li><p>Check whether the values and distribution of values of velocities, forces, and pressures are realistic.</p></li>
<li><p>Perform simple hand calculations in a smaller number of grids to check the orders of magnitude of variables. Alternatively, compare with similar problems or simplified versions of the same problem.</p></li>
<li><p>Perform a sensitivity analysis by changing the grid size, effects of boundary conditions, and turbulence models.</p></li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018-2021, The Regents of the University of California.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-158130480-4', 'auto');
    
    ga('send', 'pageview');
    </script>

    
    

  <style>
         .wy-nav-content { max-width: none; }
  </style>

<script>
    /*
    let selectedFilters = [];
    const images  = document.getElementsByClassName("gallery-item");
    const filters = [...document.querySelectorAll('.filter select')];
    const toggles = [...document.querySelectorAll('.filter input')];

    var show = function (elem) {
        elem.style.display = 'block';
    };
    var hide = function (elem) {
        elem.style.display = 'none';
    };
    var toggleFilter =  function(el,elid) {
        const filter = document.getElementById(elid);
        filter.disabled = !el.checked;
       
        if ("createEvent" in document) {
            var evt = document.createEvent("HTMLEvents");
            evt.initEvent("change", false, true);
            filter.dispatchEvent(evt);
        }
        else
            filter.fireEvent("change");
    };
    
    for (const filter of filters) {
        filter.addEventListener('change', function(event) {
            selectedFilters = filters.map(filter => filter.disabled ? '' : filter.value).filter(Boolean);
            console.log(selectedFilters);
            for (const image of images) {
                if (selectedFilters.every(filter => image.classList.contains(filter))) {
                    show(image);
                }
                else {hide(image)};
            };
        })
    };
    */
</script>


</body>
</html>