

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Shear Building: Sampling, Reliability and Sensitivity &mdash; Quantified Uncertainty with Optimization for the FEM  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F2F2F2" >
          

          
            <a href="../../../../../index.html">
          

          
            
            <img src="../../../../../_static/quoFEM-LogoImageGrey.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../ack.html">1. Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about/quoFEM/aboutQUOFEM.html">2. About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/desktop/installation.html">3. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/desktop/usage.html">4. User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshooting/desktop/troubleshooting.html">5. Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">6. Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../bugs.html">7. Bugs &amp; Feature Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">8. Copyright and License</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../technical_manual/desktop/technical_manual.html">1. Technical Manual</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_manual/how_to_build/desktop/how_to_build.html">1. How to Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_manual/architecture/desktop/architecture.html">2. Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_manual/how_to_extend/desktop/how_to_extend.html">3. How to Extend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_manual/verification/desktop/verification.html">4. Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_manual/coding_style/desktop/coding_style.html">5. Coding Style</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Quantified Uncertainty with Optimization for the FEM</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
        
      <li>Shear Building: Sampling, Reliability and Sensitivity</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../../_sources/common/user_manual/examples/desktop/EE-UQ/ShearBuilding3.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="shear-building-sampling-reliability-and-sensitivity">
<h1>Shear Building: Sampling, Reliability and Sensitivity<a class="headerlink" href="#shear-building-sampling-reliability-and-sensitivity" title="Permalink to this headline">¶</a></h1>
<p>Consider the problem of uncertainty quantification in a three story shear building</p>
<div class="align-center figure" id="id3">
<a class="reference internal image-reference" href="../../../../../_images/shear.png"><img alt="../../../../../_images/shear.png" src="../../../../../_images/shear.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">Three Story Shear Building Model (P10.2.9, “Dynamics of Structures”, A.K.Chopra)</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>The structure has uncertain properties that all follow normal distribution:</p>
<ol class="arabic simple">
<li><p>Weight of Typical Floor(w): mean <span class="math notranslate nohighlight">\(\mu_E=100 kip\)</span> and standard deviation <span class="math notranslate nohighlight">\(\sigma_E =10 kip\)</span> (COV = 10%)</p></li>
<li><p>Weight of Roof(wR): mean <span class="math notranslate nohighlight">\(\mu_E=50 kip\)</span> and standard deviation <span class="math notranslate nohighlight">\(\sigma_E =5 kip\)</span> (COV = 10%)</p></li>
<li><p>Story Stiffness (k): mean <span class="math notranslate nohighlight">\(\mu_k =326.32 kip/in\)</span> and a standard deviation of <span class="math notranslate nohighlight">\(\sigma_P = 3 kN\)</span>, (COV = 12%).</p></li>
</ol>
<p>The goal of the exercise is to estimate the mean and standard deviation of the relative displacement of node <strong>4</strong> when subject to:
1. ElCentro ground motion
2. ElCEntro &amp; Rinaldi E and W components.
3. A Selection of ground motions selected from the PEER NGA database.</p>
<p>The exercise will use both the MDOF, <code class="xref std std-numref docutils literal notranslate"><span class="pre">lblMDOF</span></code>,  and OpenSees, <code class="xref std std-numref docutils literal notranslate"><span class="pre">lblOpenSeesSIM</span></code>, structural generators. For the OpenSees generator the following model script, <a class="reference external" href="https://github.com/NHERI-SimCenter/EE-UQ/blob/master/Examples/ShearBuilding3/ShearBuilding3.tcl">ShearBuilding3.tcl</a> :</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="c">#units kips/in</span>

<span class="c"># some parameters</span>
<span class="nv">pset</span> w <span class="mf">100.0</span>
<span class="nv">pset</span> wR <span class="mf">50.0</span>
<span class="nv">pset</span> k <span class="mf">326.32</span>

<span class="k">set</span> E <span class="mf">29000.0</span>
<span class="k">set</span> A <span class="mi">1</span>e4
<span class="k">set</span> Ic <span class="k">[expr</span> <span class="nv">$k</span><span class="o">*</span><span class="mi">144</span><span class="o">*</span><span class="mi">144</span><span class="o">*</span><span class="mi">144</span><span class="o">/</span><span class="k">(</span><span class="nv">24.</span><span class="o">*</span><span class="nv">$E</span><span class="k">)]</span>
<span class="k">set</span> Ib <span class="mi">1</span>e12
<span class="k">set</span> g <span class="mf">386.1</span>

<span class="nb">puts</span> <span class="k">[expr</span> <span class="nv">$w</span><span class="o">/</span><span class="nv">$g</span><span class="k">]</span>
<span class="nb">puts</span> <span class="k">[expr</span> <span class="nv">$wR</span><span class="o">/</span><span class="nv">$g</span><span class="k">]</span>

<span class="c"># the model</span>
<span class="nv">model</span> BasicBuilder <span class="o">-</span>ndm <span class="mi">2</span> <span class="o">-</span>ndf <span class="mi">3</span>
<span class="nv">node</span> <span class="mi">1</span>    <span class="mi">0</span>.   <span class="mf">0.0</span> 
node <span class="mi">2</span>    <span class="mi">0</span>. <span class="mf">144.0</span> <span class="o">-</span>mass <span class="k">[expr</span> <span class="nv">$w</span><span class="o">/</span><span class="nv">$g</span><span class="k">]</span> <span class="k">[expr</span> <span class="nv">$w</span><span class="o">/</span><span class="nv">$g</span><span class="k">]</span>     <span class="mi">0</span>.
<span class="nv">node</span> <span class="mi">3</span>    <span class="mi">0</span>. <span class="mf">288.0</span> <span class="o">-</span>mass <span class="k">[expr</span> <span class="nv">$w</span><span class="o">/</span><span class="nv">$g</span><span class="k">]</span> <span class="k">[expr</span> <span class="nv">$w</span><span class="o">/</span><span class="nv">$g</span><span class="k">]</span>     <span class="mi">0</span>.
<span class="nv">node</span> <span class="mi">4</span>    <span class="mi">0</span>. <span class="mf">432.0</span> <span class="o">-</span>mass <span class="k">[expr</span> <span class="nv">$wR</span><span class="o">/</span><span class="nv">$g</span><span class="k">]</span> <span class="k">[expr</span> <span class="nv">$wR</span><span class="o">/</span><span class="nv">$g</span><span class="k">]</span>   <span class="mi">0</span>.
<span class="nv">node</span> <span class="mi">5</span>  <span class="mi">288</span>.   <span class="mf">0.0</span> 
node <span class="mi">6</span>  <span class="mi">288</span>. <span class="mf">144.0</span> 
node <span class="mi">7</span>  <span class="mi">288</span>. <span class="mf">288.0</span> 
node <span class="mi">8</span>  <span class="mi">288</span>. <span class="mf">432.0</span> 
fix <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="nv">fix</span> <span class="mi">5</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="nv">equalDOF</span> <span class="mi">2</span> <span class="mi">6</span> <span class="mi">1</span>
<span class="nv">equalDOF</span> <span class="mi">3</span> <span class="mi">7</span> <span class="mi">1</span>
<span class="nv">equalDOF</span> <span class="mi">4</span> <span class="mi">8</span> <span class="mi">1</span>
<span class="nv">geomTransf</span> Linear <span class="mi">1</span>
<span class="nv">element</span> elasticBeamColumn <span class="mi">1</span> <span class="mi">1</span> <span class="mi">2</span> <span class="nv">$A</span> <span class="nv">$Ic</span> <span class="nv">$E</span> <span class="mi">1</span>
<span class="nv">element</span> elasticBeamColumn <span class="mi">2</span> <span class="mi">2</span> <span class="mi">3</span> <span class="nv">$A</span> <span class="nv">$Ic</span> <span class="nv">$E</span> <span class="mi">1</span>
<span class="nv">element</span> elasticBeamColumn <span class="mi">3</span> <span class="mi">3</span> <span class="mi">4</span> <span class="nv">$A</span> <span class="nv">$Ic</span> <span class="nv">$E</span> <span class="mi">1</span>
<span class="nv">element</span> elasticBeamColumn <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="nv">$A</span> <span class="nv">$Ic</span> <span class="nv">$E</span> <span class="mi">1</span>
<span class="nv">element</span> elasticBeamColumn <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="nv">$A</span> <span class="nv">$Ic</span> <span class="nv">$E</span> <span class="mi">1</span>
<span class="nv">element</span> elasticBeamColumn <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="nv">$A</span> <span class="nv">$Ic</span> <span class="nv">$E</span> <span class="mi">1</span>
<span class="nv">element</span> elasticBeamColumn <span class="mi">7</span> <span class="mi">2</span> <span class="mi">6</span> <span class="nv">$A</span> <span class="nv">$Ib</span> <span class="nv">$E</span> <span class="mi">1</span>
<span class="nv">element</span> elasticBeamColumn <span class="mi">8</span> <span class="mi">3</span> <span class="mi">7</span> <span class="nv">$A</span> <span class="nv">$Ib</span> <span class="nv">$E</span> <span class="mi">1</span>
<span class="nv">element</span> elasticBeamColumn <span class="mi">9</span> <span class="mi">4</span> <span class="mi">8</span> <span class="nv">$A</span> <span class="nv">$Ib</span> <span class="nv">$E</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>The first lines containing pset will be read by the application when the file is selected and the application will autopopulate the Random Variables w, wR, and k in RV input panel with these same variable names. It is of course possible to explicitly use Random Variables without the pset command by “RV.**variable name” in the input file. However, no random variables will be autopopulated if user chooses this route.</p></li>
</ol>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not place the file in your root, downloads, or desktop folder as when the application runs it will copy the contents on the directories and subdirectories containig this file multiple times (a copy will be made for each sample specified). If you are like us, your root, Downloads or Documents folders contains and awful lot of files and when the backend workflow runs you will slowly find you will run out of disk space!</p>
</div>
<div class="section" id="sampling-analysis-with-elcentro">
<h2>Sampling Analysis with ElCentro<a class="headerlink" href="#sampling-analysis-with-elcentro" title="Permalink to this headline">¶</a></h2>
<p>We shall first demonstrate the stpes to perform a sampling analysis to study the effects of the roof response of models of the building subjected to the ElCentro ground motion. We shall scale the input motion using a scale factor (factorEC) following a uniform distribution between <strong>1.2</strong> and <strong>1.8</strong>, i.e. mean <span class="math notranslate nohighlight">\(\mu_{factorEC} = 1.5\)</span> and a standard deviation of <span class="math notranslate nohighlight">\(\sigma_{factorEC} = 0.1732\)</span>, (COV = 12%).</p>
<p>To perform a Sampling or Forward propogation uncertainty analysis the user would perform the following steps:</p>
<p>The steps involved:</p>
<ol class="arabic simple">
<li><p>Start the application and the UQ Selection will be highlighted. In the panel for the UQ selection, keep the UQ engine as that selected, i.e. Dakota, and the UQ Method Category as Forward Propogation, and the Forward Propagarion method as LHS (Latin Hypercude). Change the #samples to 1000 and the seed to 20 as shown in the figure.</p></li>
</ol>
<div class="align-center figure">
<img alt="../../../../../_images/shearUQ.png" src="../../../../../_images/shearUQ.png" />
</div>
<ol class="arabic simple" start="2">
<li><p>Next select the SIM tab from the input panel. This will default in the MDOF model generator. We will use this generator (the NOTE below contains instruction on how to use the OpenSees scipt instead). In the building information panel, specify number of stories as <strong>3</strong> (this will change the graphic). Also in the Building information frame specify <strong>w</strong> for the floor weights and <strong>k</strong> for story stiffness. Finally in the tabvle below, go to the third row and enter <strong>wR</strong> for the roof weight (you will notice that when you enter that table cell the node at the top of the model will turn red, indicating you are editing the information for the top most node).</p></li>
</ol>
<div class="align-center figure">
<img alt="../../../../../_images/shearSIM.png" src="../../../../../_images/shearSIM.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To specify instead to use the OpenSees script instead, from yje Model Generator pull down menu select <strong>OpenSees. For the fields in the panel presented enter the path to the **ShearBuilding3d.tcl</strong> script. Also specify thee Response Nodes as <strong>1 2 3 4</strong> in the panel. The Response nodes will tell mdeol generator which nodes correspond to nodes at the 4 floor levels for which reponses are to be obtained when using the standard earthquake EDP’s.</p>
<div class="align-center figure">
<img alt="../../../../../_images/shearSIM-OpenSees.png" src="../../../../../_images/shearSIM-OpenSees.png" />
</div>
</div>
<ol class="arabic simple" start="3">
<li><p>Next select the <strong>EVT</strong> panel. From the Load Generator pull down menu select the <strong>Multiple PEER</strong> option. This will present a panel with 3 buttons to <strong>Add</strong>, <strong>Remove</strong> and <strong>Load Directory</strong>. Press the <strong>Add</strong> button. Give the motion a name, here enter <strong>elCentro</strong> in the first line edit. Now for the motion enter the path to the <strong>elCentro.AT2</strong> motion. Leave the motion acting in the <strong>1</strong> dof direction and for this direction enter a scale factor, enter <strong>factorEC</strong>.</p></li>
</ol>
<div class="align-center figure">
<img alt="../../../../../_images/shearEVT.png" src="../../../../../_images/shearEVT.png" />
</div>
<ol class="arabic simple" start="3">
<li><p>Next choose the <strong>FEM</strong> panel. Here we will change the entries to use Rayleigh damping, with rayleigh factor chosen using <strong>1</strong> and <strong>3</strong> modes. For the <strong>MDOF</strong> model generator, because it generates a model with two translational and 1 rotational degree-of-freedom in each direction and because we have provided the same <strong>k</strong> values in each translational direction, i.e. we will have dupolicate eigen values, we specify as shown in the figure modes <strong>1</strong> and <strong>6</strong>.</p></li>
</ol>
<div class="align-center figure">
<img alt="../../../../../_images/shearFEM.png" src="../../../../../_images/shearFEM.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If instead we were using the OpenSees model, which does not have the duplicate eigen values, it being a planar problem with constrained degrees-of-freedom, we specify modes <strong>1</strong> and <strong>3</strong> as shown.</p>
<div class="align-center figure">
<img alt="../../../../../_images/shearFEM-OpenSees.png" src="../../../../../_images/shearFEM-OpenSees.png" />
</div>
</div>
<ol class="arabic simple" start="4">
<li><p>We will skeip the <strong>EDP</strong> panel leaving it in it’s default condition, that being to use the <strong>Standard Earthquake</strong> EDP generator.</p></li>
<li><p>For the <strong>RV</strong> panel, we will enter the distributions and values for our random variables. Because of the steps we have followed and entries we have made, the panel when we open it should contain the <strong>4</strong> random variables and they should all be set constant. For the w, wR and k random variables we change the distributions to normal and enter the values given for the problem, as shown in figure below. For the factorEC variable, we change the distribution to <strong>uniform</strong> and enter the values.</p></li>
</ol>
<div class="align-center figure">
<img alt="../../../../../_images/shearRV.png" src="../../../../../_images/shearRV.png" />
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The user cannot leave any of the distributions for these values as constant for the Dakota UQ engine.</p>
</div>
<ol class="arabic simple" start="5">
<li><p>Next click on the ‘Run’ button. This will cause the backend application to launch dakota. When done the RES panel tab will be selected and the results will be displayed. The results show the values the mean and standard deviation. The relative displacement of the roof, is the quantity <strong>1-PFD-3-1</strong> (first event (tool to be extended to multiple events), 3rd floor (in US ground floor considered 0), and 1 dof direction).</p></li>
</ol>
<div class="align-center figure">
<img alt="../../../../../_images/shearRES1.png" src="../../../../../_images/shearRES1.png" />
</div>
<p>If the user selects the “Data” tab in the results panel, they will be presented with both a graphical plot and a tabular listing of the data. By left- and right-clicking with the mouse in the individual columns the axis change (left mouse click controls vertical axis, right mouse click the horizontal axis).</p>
<div class="align-center figure">
<img alt="../../../../../_images/shearRES7.png" src="../../../../../_images/shearRES7.png" />
</div>
<p>Various views of the graphical display can be obtained by left and right clicking in the columns of the tabular data. If a singular column of the tabular data is pressed with both right and left buttons a freequency and CDF will be displayed, as shown in figure below.</p>
<div class="align-center figure">
<img alt="../../../../../_images/shearRES6.png" src="../../../../../_images/shearRES6.png" />
</div>
</div>
<div class="section" id="sampling-analysis-with-elcentro-and-reduced-output">
<h2>Sampling Analysis with ElCentro and Reduced Output<a class="headerlink" href="#sampling-analysis-with-elcentro-and-reduced-output" title="Permalink to this headline">¶</a></h2>
<p>In the previous example we got the standard output, which can be both a lot and also limited (in sense you don’t get the information you want). In this example we will present how to obtain results just for the roof displacement, the displacement of node <strong>4</strong> in both the <strong>MDOF</strong> and <strong>OpenSees</strong> model generator examples. The examples could be extended to output for example the story shear forces, element forces, element end rotations, …</p>
<p>For this example you will need two additional file <a class="reference external" href="https://github.com/NHERI-SimCenter/EE-UQ/blob/master/Examples/ShearBuilding3/recorderCommands.tcl">recorderCommands.tcl</a> and <a class="reference external" href="https://github.com/NHERI-SimCenter/EE-UQ/blob/master/Examples/ShearBuilding3/postprocess.tcl">postprocess.tcl</a>.</p>
<p>The recorderCommands script as shown will record the envelope displacements in the first two degrees-of-freedom for nodes <strong>1</strong> through <strong>4</strong>. The file is as shown below:</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="nv">recorder</span> EnvelopeNode <span class="o">-</span>file node.out <span class="o">-</span>node <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="o">-</span>dof <span class="mi">1</span> <span class="mi">2</span> disp
<span class="nv">recorder</span> EnvelopeElement <span class="o">-</span>file forces.out <span class="o">-</span>ele <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> forces
</pre></div>
</div>
<p>The postprocess.tcl script shown below will accept as input any of the 4 nodes <a href="#id1"><span class="problematic" id="id2">*</span></a>in the domain and for each of the two dof directions.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="k">set</span> nodeIn <span class="k">[</span><span class="nb">open</span> node.out r<span class="k">]</span>
<span class="k">while</span> <span class="k">{</span> <span class="k">[</span><span class="nb">gets</span> <span class="nv">$nodeIn</span> data<span class="k">]</span> <span class="o">&gt;=</span> <span class="nv">0</span> <span class="k">}</span> <span class="k">{</span>
     <span class="k">set</span> maxDisplacement <span class="nv">$data</span>
<span class="k">}</span>
<span class="nb">puts</span> <span class="nv">$maxDisplacement</span>

<span class="c"># create file handler to write results to output &amp; list into which we will put results</span>
<span class="k">set</span> resultFile <span class="k">[</span><span class="nb">open</span> results.out w<span class="k">]</span>
<span class="k">set</span> results <span class="k">[]</span>

<span class="c"># for each quanity in list of QoI passed</span>
<span class="c">#  - get nodeTag</span>
<span class="c">#  - get nodal displacement if valid node, output 0.0 if not</span>
<span class="c">#  - for valid node output displacement, note if dof not provided output 1&#39;st dof</span>

<span class="k">foreach</span> edp <span class="nv">$listQoI</span> <span class="k">{</span>
	<span class="k">set</span> splitEDP <span class="k">[</span><span class="nb">split</span> <span class="nv">$edp</span> <span class="s2">&quot;_&quot;</span><span class="k">]</span>	
	set nodeTag <span class="k">[</span><span class="nb">lindex</span> <span class="nv">$splitEDP</span> <span class="mi">1</span><span class="k">]</span>
        <span class="k">if</span> <span class="k">{[</span><span class="nb">llength</span> <span class="nv">$splitEDP</span><span class="k">]</span> <span class="o">==</span> <span class="nv">3</span><span class="k">}</span> <span class="k">{</span>
           <span class="k">set</span> dof <span class="mi">1</span>
	<span class="k">}</span> <span class="k">else</span> <span class="k">{</span>
            <span class="k">set</span> dof <span class="k">[</span><span class="nb">lindex</span> <span class="nv">$splitEDP</span> <span class="mi">3</span><span class="k">]</span>
	<span class="k">}</span> 
    set nodeDisp <span class="k">[</span><span class="nb">lindex</span> <span class="nv">$maxDisplacement</span> <span class="k">[expr</span> <span class="k">((</span><span class="nv">$nodeTag-1</span><span class="k">)</span><span class="o">*</span><span class="nv">2</span><span class="k">)</span><span class="o">+</span><span class="nv">$dof-1</span><span class="k">]]</span>
	<span class="nb">lappend</span> results <span class="nv">$nodeDisp</span>
<span class="k">}</span>

<span class="c"># send results to output file &amp; close the file</span>
<span class="nb">puts</span> <span class="nv">$resultFile</span> <span class="nv">$results</span>
<span class="nb">close</span> <span class="nv">$resultFile</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The use has the option to provide no postprocess script (in which case the main script must create a results.out file containg a single line with as many space seperated numbers as QoI or the user may provide a python script that also performs the postprocessing. An example of a postprocessing python script is <a class="reference external" href="https://github.com/NHERI-SimCenter/EE-UQ/blob/master/examples/ShearBuilding3/postprocess.py">postprocess.py</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python</span>

<span class="c1"># written: fmk, adamzs 01/18</span>

<span class="c1"># import functions for Python 2.X support</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">):</span> 
    <span class="nb">range</span><span class="o">=</span><span class="n">xrange</span>
    <span class="n">string_types</span> <span class="o">=</span> <span class="n">basestring</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">string_types</span> <span class="o">=</span> <span class="nb">str</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">process_results</span><span class="p">(</span><span class="n">inputArgs</span><span class="p">):</span>

    <span class="c1">#</span>
    <span class="c1"># process output file &quot;node.out&quot; for nodal displacements</span>
    <span class="c1">#</span>

    <span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s1">&#39;node.out&#39;</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inFile</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">inFile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">inFile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">inFile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">displ</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">numNode</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">displ</span><span class="p">)</span>

    <span class="n">inFile</span><span class="o">.</span><span class="n">close</span>

    <span class="c1"># now process the input args and write the results file</span>

    <span class="n">outFile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;results.out&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

    <span class="c1"># note for now assuming no ERROR in user data</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inputArgs</span><span class="p">:</span>

        <span class="n">theList</span><span class="o">=</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">theList</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">dof</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">theList</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dof</span> <span class="o">=</span> <span class="mi">1</span>
                      
        <span class="k">if</span> <span class="p">(</span><span class="n">theList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Node&quot;</span><span class="p">):</span>
            <span class="n">nodeTag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">theList</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">nodeTag</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">nodeTag</span> <span class="o">&lt;=</span> <span class="n">numNode</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">theList</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Disp&quot;</span><span class="p">):</span>
                    <span class="n">nodeDisp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">displ</span><span class="p">[((</span><span class="n">nodeTag</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">dof</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                    <span class="n">outFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nodeDisp</span><span class="p">))</span>
                    <span class="n">outFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">outFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;0. &#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;0. &#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;0. &#39;</span><span class="p">)</span>

    <span class="n">outFile</span><span class="o">.</span><span class="n">close</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">responses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="n">process_results</span><span class="p">(</span><span class="n">responses</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The steps are the same as the previous example, with exception of step 4 defining the <strong>EDP</strong>. 5.</p>
<ol class="arabic simple">
<li><p>For the <strong>EDP</strong> panel, we will change the generator to <strong>User Defined</strong>. In the panel that presents itself the user must provide the paths to both the recorder commands and the postprocessing script. Next the user must provide information on the response parameters they are interested in. The user presses the <code class="docutils literal notranslate"><span class="pre">Add</span></code> button and the enters <strong>Node_4_Disp_1</strong> in the entry field as shown in figure below.</p></li>
</ol>
<div class="align-center figure">
<img alt="../../../../../_images/shearEDP-U.png" src="../../../../../_images/shearEDP-U.png" />
</div>
<ol class="arabic simple" start="2">
<li><p>Next click on the ‘Run’ button. This will cause the backend application to launch dakota. When done the RES panel tab will be selected and the results will be displayed. The results show the values the mean and standard deviation as before but now only for the one quantatity of interest.</p></li>
</ol>
<div class="align-center figure">
<img alt="../../../../../_images/shearRES-UO.png" src="../../../../../_images/shearRES-UO.png" />
</div>
</div>
<div class="section" id="global-sensitivity">
<h2>Global Sensitivity<a class="headerlink" href="#global-sensitivity" title="Permalink to this headline">¶</a></h2>
<p>In a global sensitivity analysis the user is wishing to understand what is the influence of the individual random variables on the quantities of interest. This is typically done before the user launches large scale forward uncertainty problems in order to limit the number of random variables used so as to limit the number of simulations performed.</p>
<p>To perform a reliability analysis the steps above would be repeated with the exception that the user would select a reliability analysis method instead of a Forward Propogation method. To obtain reliability results using the global reliability method for this problem the user would follow the same sequence of steps as previously. The difference would be in the UQ tab in which the user would select a Reliability as the Dakota Method Catagory and then choose GLobal reliability. In the figure the user is specifying that they are interested in the probability that the displacement will exceed certain response levels.</p>
<div class="align-center figure">
<img alt="../../../../../_images/shearSensitivityUQ.png" src="../../../../../_images/shearSensitivityUQ.png" />
</div>
<p>After the user fills in the rest of the tabs as per the previous section, the user would then press the ‘’RUN’’ button. The application (after spinning for a while with the wheel of death) will present the user with the results.</p>
<div class="align-center figure">
<img alt="../../../../../_images/shearSensitivityRES.png" src="../../../../../_images/shearSensitivityRES.png" />
</div>
<p>The results showing that the earthquake factor has the largest influence on the response followed  by the stiffness value k, as the results graphically would indicate.</p>
</div>
<div class="section" id="reliability-analysis">
<h2>Reliability Analysis<a class="headerlink" href="#reliability-analysis" title="Permalink to this headline">¶</a></h2>
<p>If the user is interested in the probability that certain response measure will be exceeded an alternative strategy is to perform a reliability analysis. To perform a reliability analysis the steps above would be repeated with the exception that the user would select a reliability analysis method instead of a Forward Propogation method. To obtain reliability results using the Global Reliability method presnet in dakota choose the Global Reliability methods from the methods drop down menu. In the response levels enter a value of <strong>2.5</strong>, specyfying that we are interested in the value of the CDF for a displacement of the roof of 2.5in, i.e. what is probability that displacement will be less than 2.5in.</p>
<div class="align-center figure">
<img alt="../../../../../_images/shearReliabilityUQ.png" src="../../../../../_images/shearReliabilityUQ.png" />
</div>
<p>After the user fills in the rest of the tabs as per the previous section, the user would then press the ‘’RUN’’ button. The application (after spinning for a while with the wheel of death) will present the user with the results, which as shown below, indicate that the probability is <strong>91.5%</strong>/</p>
<div class="align-center figure">
<img alt="../../../../../_images/shearReliabilityRes.png" src="../../../../../_images/shearReliabilityRes.png" />
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Reliability analsyis can only be performed when their is only one EDP.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2020, The Regents of the University of California

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-158130480-1', 'auto');
    ga('send', 'pageview');
    </script>

    
    

  <style>
         .wy-nav-content { max-width: none; }
  </style>



</body>
</html>